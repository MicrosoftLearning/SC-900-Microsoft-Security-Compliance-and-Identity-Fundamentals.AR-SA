<div id="readme" class="Box-body readme blob js-code-block-container p-5 p-xl-6 gist-border-0" dir="rtl">
    <article class="markdown-body entry-content container-lg" itemprop="text"><table>
  <thead>
  <tr>
  <th>lab</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div><table>
  <thead>
  <tr>
  <th>title</th>
  <th>module</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>استكشاف مجموعات أمان الشبكة (NSGs) في Azure</div></td>
  <td><div>الوحدة 3، الدرس 1: وصف قدرات حلول الأمان في Microsoft: وصف قدرات الأمان الأساسية في Azure.</div></td>
  </tr>
  </tbody>
</table>
</div></td>
  </tr>
  </tbody>
</table>


# النشاط المعملي: استكشاف مجموعات أمان الشبكة (NSGs) في Azure.

## سيناريو النشاط المعملي
في هذا النشاط المعملي، ستستكشف وظيفة مجموعات أمان الشبكة في Azure.  ستفعل ذلك عن طريق إنشاء الجهاز الظاهري بدون أي مجموعة أمان للشبكة (NSG).  بدون أي NSG لتصفية حركة البيانات، فإن جميع المنافذ الموجودة في الجهاز الظاهري معرضة للإنترنت العام.  ستنتقل بعد ذلك إلى عملية إنشاء NSG وتعيين واجهة الجهاز الظاهري إلى NSG.  بمجرد التكوين، ستختبر الاتصال بالجهاز الظاهري، باستخدام قواعد مجموعة أمان الشبكة الافتراضية بالإضافة إلى القواعد التي ستنشئها.
  

**الزمن المقدر**: 15-20 دقائق

#### المهمة 1:  في هذه المهمة، سننشئ جهازًا ظاهريًا يعمل بنظام Windows 10.    
1.	افتح مستعرض Microsoft Edge.  في شريط العناوين، أدخل **portal.azure.com.**

1. سجل الدخول باستخدام بيانات اعتماد المسؤول خاصتك.
    1. في نافذة تسجيل الدخول، أدخل **admin@WWLxZZZZZZ.onmicrosoft.com** (حيث ZZZZZZ هو معرف المستأجر الفريد الذي يوفره موفر استضافة النشاط المعملي خاصتك) ثم حدد **التالي**.

    1. أدخل كلمة مرور المسؤول التي يجب أن يوفرها موفر استضافة النشاط المعملي خاصتك. حدد **تسجيل الدخول**.
    1. عند مطالبتك بالبقاء مسجلاً للدخول، حدد **نعم**.
1. في الزاوية العلوية اليسرى من الشاشة، بجوار المكان الذي تظهر فيع عبارة Microsoft Azure، حدد إظهار أيقونة قائمة المدخل (يُشار إلى الخطوط الأفقية الثلاثة أيضًا باسم أيقونة الهامبرغر) ثم حدد **كل الخدمات**.  
1. في النافذة الرئيسية، ضمن المميزة، حدد الأجهزة الافتراضية.  إذا كنت لا ترى الأجهزة الظاهرية مدرجة، فأدخلها في شريط البحث، ثم حددها من نتائج البحث.
1. من أعلى يسار الصفحة، حدد **+إنشاء** ثم حدد **+جهاز ظاهري**.
1. من علامة تبويب الأساسيات، املأ المعلومات التالية (لأي شيء غير مدرج، اترك الإعدادات الافتراضية):
    1. الاشتراك: تحقق من الإعداد الافتراضي ليكون Azure Pass - وصول محدود.

    1. مجموعة الموارد:  حدد **إنشاء جديد** ثم في حقل الاسم، أدخل **LabsSC900**، ثم حدد **موافق**.
    1. اسم الأجهزة الظاهرية:  أدخِل **SC900-WinVM**.
    1. الصورة:  من القائمة المنسدلة، حدد **Windows 10 Pro، الإصدار 20H2 - الجيل 1**.
    1. الحجم:  حدد **عرض جميع الأحجام** من القائمة المنسدلة وحدد **B2s**، ثم اضغط على **تحديد** في أسفل الصفحة.
    1. اسم المستخدم:  أدخِل **AzureUser**.
    1. كلمة المرور:  أدخِل **SC900AzureLabs**.
    1. منافذ الوارد العامة:  حدد **لا شيء**.
    1. الترخيص:  حدد **أؤكد أن لدي ترخيص Windows 10 مؤهل مع حقوق استضافة متعددة المستأجرين**، بحيث تظهر علامة الاختيار في المربع.
    1. حدد **التالي: الأقراص**. 
1. أنت الآن في علامة تبويب الأقراص لتكوين الجهاز الظاهري.  اترك جميع الإعدادات على الوضع الافتراضي وحدد **التالي: الشبكات**.
1. أنت الآن في علامة تبويب الشبكات لتكوين الجهاز الظاهري.  املأ المعلومات التالية (لأي شيء غير مدرج، اترك الإعدادات الافتراضية):
    1. مجموعة أمان شبكة NIC:  حدد **لا شيء**.

    1. حدد **التالي: الإدارة >**.
1. أنت الآن في علامة تبويب "الإدارة" لتكوين الجهاز الظاهري.  اترك جميع الإعدادات على الوضع الافتراضي وحدد **التالي: متقدم>**.
1. أنت الآن في علامة تبويب "متقدم" لتكوين الجهاز الظاهري.  اترك جميع الإعدادات على الوضع الافتراضي وحدد **التالي: العلامات**.
1. أنت الآن في علامة تبويب "العلامات" لتكوين الجهاز الظاهري.  اترك جميع الإعدادات على الوضع الافتراضي وحدد **التالي: مراجعة + إنشاء**.
1. راجع التكوين للجهاز الظاهري خاصتك.  بعض النقاط التي يجب ملاحظتها: يحتوي الجهاز الظاهري هذا على عنوان IP عام ولا يحتوي على مجموعة أمان شبكة NIC.  من منظور الأمان، فإن هذا يترك الجهاز الظاهري مكشوفًا.  سنعالج هذا في مهمة لاحقة. حدد "إنشاء".  قد يستغرق اكتمال نشر الجهاز الظاهري عدة دقائق.
1. لاحظ اسم واجهة الشبكة، **sc900-winvmXXX** (سيكون XXX خاصًا بواجهة الشبكة للجهاز الظاهري خاصتك).
1. بمجرد اكتمال توزيع الجهاز الظاهري، حدد **انتقال إلى المورد**.
1. أنت الآن في صفحة SC900-WinVM.  لاحظ عنوان IP العام. 
1. من أعلى الصفحة، حدد **اتصال** ثم من القائمة المنسدلة حدد **RDP**.
1. تحقق من تعيين عنوان IP على عنوان IP العام، واترك رقم المنفذ على الإعداد الافتراضي وحدد **تنزيل ملف بروتوكول سطح المكتب البعيد**. 
1. افتح الملف الذي تم تنزيله وحدد **اتصال**. 
1. سيُطلب منك بيانات الاعتماد خاصتك.  بالنسبة لاسم المستخدم، أدخل **AzureUser**.  بالنسبة لكلمة المرور، أدخل **SC900AzureLabs**. 
1. تفتح نافذة اتصال سطح المكتب البعيد تشير إلى أنه لا يمكن التحقق من هوية الكمبيوتر البعيد.  هل ترغب في الاتصال على أي حال؟  حدد **نعم**.
1. أنت الآن متصل بجهاز Windows الظاهري الذي أنشأته للتو. اتبع المطالبات لإكمال إعداد Windows. رغم أنك متصل بالجهاز الظاهري عبر بروتوكول سطح المكتب البعيد ومنفذ بروتوكول سطح المكتب البعيد شائع الاستخدام، فإن جميع المنافذ مفتوحة في هذا الجهاز الظاهري ولا يوجد شيء يقوم بتصفية حركة المرور. 
1. أغلق اتصال سطح المكتب البعيد، عن طريق تحديد **X** في أعلى منتصف الصفحة حيث يظهر عنوان IP.  تشير النوافذ المنبثقة إلى أنه سيتم فصل جلسة عملك البعيدة. حدد **موافق**.
1. لقد عُدتَ الآن إلى صفحة SC900-WinVM في مدخل Azure.  اترك علامة تبويب المستعرض مفتوحة للمهمة التالية.

#### المهمة 2:  أنشئ مجموعة أمان شبكة، وعيِّن واجهة شبكة الجهاز الظاهري لمجموعة أمان الشبكة تلك.

1. افتح علامة تبويب SC900-WinVM – Microsoft Azure في المستعرض.

1. من الزاوية العلوية اليسرى من الصفحة، بجوار المكان الذي تظهر فيع عبارة Microsoft Azure، حدد إظهار أيقونة قائمة المدخل (يُشار إلى الخطوط الأفقية الثلاثة أيضًا باسم أيقونة الهامبرغر) ثم حدد **كل الخدمات**.
1. في مربع تصفية الخدمات بجوار المكان الذي تظهر فيه جميع الخدمات، أدخل **مجموعات أمان الشبكة** ثم من النتائج، حدد **مجموعات أمان الشبكة** (لا تحدد مجموعات أمان الشبكة الكلاسيكية).
1. من أعلى صفحة مجموعات أمان الشبكة، حدد **+ إنشاء**.
1. في علامة تبويب الأساسيات في صفحة إنشاء مجموعة أمان الشبكة، حدد الإعدادات التالية:
    1. الاشتراك:  Azure Pass – وصول محدود

    1. مجموعة الموارد:  **LabsSC900**
    1. الاسم:  **NSG-SC900**
    1. المنطقة:  اترك الإعداد الافتراضي **(الولايات المتحدة) شرق الولايات المتحدة**
    1. حدد **مراجعة + إنشاء**، ثم حدد **إنشاء**.
1. بمجرد اكتمال النشر، حدد **انتقال إلى المورد**.
1. لاحظ القواعد الافتراضية الواردة والصادرة في مجموعة أمان الشبكة.  فرغم إنشاء مجموعة أمان الشبكة وهناك قواعد افتراضية لتصفية نسبة استخدام الشبكة، لم يتم ربط أي واجهة بمجموعة أمان الشبكة. لذلك، لا يزال الجهاز الافتراضي ضعيفًا مع تعرض جميع منافذه للإنترنت العام.
1. من جزء التنقّل الأيسر في صفحة NSG-SC900، ضمن الإعدادات، حدد **واجهات الشبكة**.
1. حدد **+ربط**، أعلى مربع البحث.
1. من صفحة واجهة الشبكة المرتبطة، حدد **sc900-winvmXXX** (سيكون XXX خاصًا بواجهة الشبكة للجهاز الظاهري خاصتك).  أثناء اقتران الواجهة، سترى مربع إخطار في الزاوية العلوية اليمنى من الشاشة.
1. بمجرد ربط الواجهة بمجموعة أمان الشبكة، ستظهر في القائمة.
1. مع واجهة الأجهزة الظاهرية المرتبطة بمجموعة أمان الشبكة وقواعد مجموعات أمان الشبكات الظاهرية، يجب أن تفشل أي محاولة للاتصال بالجهاز الظاهري.  
1. من الزاوية العلوية اليسرى من الصفحة، حدد **كل الخدمات**، ثم أسفل المكان الذي تظهر فيه كلمة مميز، حدد **الأجهزة الافتراضية**.
1. من صفحة الأجهزة الظاهرية، حدد **SC900-WinVM**.
1. من أعلى صفحة **SC900-WinVM**، حدد **اتصال** ثم حدد **بروتوكول سطح المكتب البعيد**.
1. تحقق من تعيين عنوان IP على عنوان IP العام، واترك رقم المنفذ على الإعداد الافتراضي وحدد **تنزيل ملف بروتوكول سطح المكتب البعيد**.
1. افتح الملف الذي تم تنزيله وحدد **اتصال**.
1. بعد بضع ثوانٍ من محاولة الاتصال، سترى رسالة الفشل، تشير إلى أن سطح المكتب البعيد لا يمكنه الاتصال بالكمبيوتر البعيد.  حدد **موافق**.

#### المهمة 3: في هذه المهمة، ستقوم بإنشاء قاعدة NSG للسماح بحركة البيانات الواردة باستخدام RDP على المنفذ 3389.  ستختبر هذه القاعدة بعد ذلك بمحاولة الاتصال بالجهاز الظاهري باستخدام RDP. 

1. افتح علامة تبويب SC900-WinVM – Microsoft Azure في المستعرض.

1. من جزء التنقّل الأيسر، ضمن الإعدادات، حدد **الشبكة**.
1. مع تحديد علامة التبويب قواعد منفذ الوارد، سترى قواعد الوارد الافتراضية. لا يمكنك إزالة القواعد الافتراضية، ولكن يمكنك تجاوزها بإنشاء قواعد ذات أولويات أعلى. من الجانب الأيمن من الصفحة، حدد إضافة **قاعدة منفذ الوارد**:
1. في صفحة إضافة قاعدة أمان الوارد، حدد الإعدادات التالية:
    1. المصدر:  **أي**

    1. نطاقات منفذ المصدر: *
    1. الوجهة:  **أي**
    1. الخدمة:  **RDP**
    1. الإجراء:  **السماح**
    1. الأولوية:  **300**؛ ملاحظة: القواعد ذات الأرقام الأقل لها أولوية أعلى وتتم معالجتها أولاً.
    1. الاسم:  **AllowRDP**
1. حدد **إضافة**
1. بمجرد توفير القاعدة، ستظهر في قائمة قواعد الوارد.
1. الآن قم بالتحقق من أنه يمكنك الاتصال بالجهاز الظاهري باستخدام بروتوكول سطح المكتب البعيد.  حدد **اتصال** من لوحة التنقل اليسرى.
1. تحقق من تعيين عنوان IP على عنوان IP العام، واترك رقم المنفذ على الإعداد الافتراضي وحدد **تنزيل ملف بروتوكول سطح المكتب البعيد**.
1. افتح الملف الذي تم تنزيله وحدد **اتصال**.
1. سيُطلب منك بيانات الاعتماد خاصتك.  بالنسبة لاسم المستخدم، أدخل **AzureUser**.  بالنسبة لكلمة المرور، أدخل **SC900AzureLabs**.
1. تفتح نافذة اتصال سطح المكتب البعيد تشير إلى أنه لا يمكن التحقق من هوية الكمبيوتر البعيد.  هل ترغب في الاتصال على أي حال؟  حدد **نعم**.
1. أنت الآن متصل بجهاز ظاهري. في هذه الحالة كان بإمكانك الاتصال بالجهاز الافتراضي لأن قاعدة نسبة استخدام الشبكة الواردة التي أنشأتها تسمح بنسبة استخدام الشبكة الواردة إلى الجهاز الظاهري عبر بروتوكول سطح المكتب البعيد.
1. اترك هذا الجهاز الظاهري مفتوحًا، ستستخدمه في المهمة التالية.

#### المهمة 4:  تسمح القواعد الافتراضية الصادرة لمجموعة NSG بحركة بيانات الإنترنت الصادرة حتى تتحقق من أنه يمكنك الاتصال بالإنترنت.  ستنتقل بعد ذلك إلى عملية إنشاء قاعدة مخصصة للخارج لحظر حركة بيانات الإنترنت الصادرة واختبار هذه القاعدة.

1. من الجهاز الظاهري، حدد **Edge** لفتح المستعرض.  
1. أدخل **https://www.bing.com** في شريط عنوان المستعرض وتأكد من قدرتك على الاتصال بمحرك البحث.
1. أغلق المستعرض على الجهاز الظاهري خاصتك، ولكن احتفظ به مفتوحًا، حيث ستستخدمه في الخطوات التالية.
1. ارجع إلى مدخل Azure، وافتح علامة التبويب SC900-WinVM - Microsoft Azure في المستعرض خاصتك.
1. من جزء التنقّل الأيسر، ضمن الإعدادات، حدد **الشبكة**.
1. حدد علامة التبويب **قواعد منفذ الصادر**.  سترى قواعد الصادر الافتراضية.  لاحظ القاعدة الافتراضية "AllowInternetOutBound". تسمح هذه القاعدة بكل حركة الإنترنت الصادرة. لا يمكنك إزالة القاعدة الافتراضية، ولكن يمكنك تجاوزها بإنشاء قواعد ذات أولويات أعلى. من الجانب الأيمن من الصفحة، حدد إضافة **قاعدة منفذ الصادر**.
1. في صفحة إضافة قاعدة أمان الوارد، حدد الإعدادات التالية:
    1. المصدر:  **أي**

    1. نطاقات منفذ المصدر:  *
    1. الوجهة:  **علامة الخدمة**
    1. علامة خدمة الوجهة:  **الإنترنت**
    1. الخدمة:  **مخصص** (اترك الإعداد الافتراضي)
    1. نطاقات منفذ الوجهة:  * (تأكد من وضع علامة النجمة في حقل نطاقات منفذ الوجهة)
    1. البروتوكول: **أي**
    1. الإجراء: **الرفض**
    1. الأولوية:  **4000**
    1. الاسم:  **DenyInternet**
1. حدد **إضافة**
1. بمجرد توفير القاعدة، ستظهر في قائمة قواعد الوارد.  على الرغم من ظهوره في القائمة، إلا أنه سيستغرق بضع دقائق حتى يصبح ساريًا (انتظر بضع دقائق قبل متابعة الخطوات التالية).  
1. عُد إلى الجهاز الظاهري خاصتك
1. افتح مستعرض Edge في الجهاز الظاهري خاصتك وأدخل **https://www.bing.com**.  لا ينبغي عرض الصفحة.  ملاحظة: إذا كنتَ قادرًا على الاتصال بالإنترنت وتحققتَ من تعيين جميع معلمات القاعدة الصادرة بشكلٍ صحيح، فمن المحتمل أن يستغرق الأمر بضع دقائق حتى تصبح القاعدة سارية المفعول.  أغلق المستعرض، انتظر بضع دقائق وحاول مرة أخرى.
1. أغلق اتصال سطح المكتب البعيد، عن طريق تحديد **X** في أعلى منتصف الصفحة حيث يظهر عنوان IP.  تشير النوافذ المنبثقة إلى أنه سيتم فصل جلسة عملك البعيدة. حدد **موافق**.
1. في هذه المهمة، نجحت في تكوين قاعدة صادر في NSG خاصتك، لحظر حركة الإنترنت الصادرة.

#### المهمة 5:  هام: في هذه المهمة ستحذف مجموعة الموارد وجميع الموارد التي تحتوي عليها.   هذه خطوة مهمة لتجنب الرسوم الإضافية.

1. افتح علامة تبويب SC900-WinVM – Microsoft Azure في المستعرض.

1. من الزاوية العلوية اليسرى من الصفحة، حدد **كل الخدمات**.
1. في مربع تصفية الخدمات بجوار مكان وجود عبارة جميع الخدمات، أدخل **مجموعات الموارد** ثم من النتائج، حدد **مجموعات الموارد**.
1. حدد **LabsSC900**.
1. من أعلى منتصف صفحة LabsSC900، حدد **حذف مجموعة الموارد**.
1. في النافذة التي تفتح، أدخل اسم مجموعة الموارد، **LabsSC900**، لتأكيد حذف مجموعة الموارد وجميع مواردها، ثم حدد **حذف** من أسفل الصفحة.
1. قد يستغرق حذف جميع الموارد ومجموعة الموارد بضع دقائق.

#### المراجعة

في هذا النشاط المعملي، استكشفت عملية إعداد جهاز افتراضي مع مجموعة أمان الشبكة (NSG) وبدونها، وشاهدت تأثير القواعد الافتراضية لمجموعة NSG.  واستكشفت أيضًا عملية إنشاء قواعد NSG.
