---
lab:
  title: استكشاف مجموعات أمان الشبكة (NSGs) في Azure
  module: Describe the basic security capabilities in Azure
---

# النشاط المعملي: استكشاف مجموعات أمان شبكة Azure (NSGs)

يقوم هذا النشاط المعملي بتعيين محتوى Learn التالي:

- مسار التعليم: وصف إمكانات حلول الأمان من Microsoft
- الوحدة النمطية: وصف إمكانات الأمان الأساسية في Azure
- الوحدة: وصف مجموعات أمان شبكة Azure

## سيناريو النشاط المعملي

في هذا النشاط المعملي، ستستكشف وظيفة مجموعات أمان الشبكة في Azure.  ستتولى ذلك عن طريق إنشاء مجموعة أمان شبكة (NSG) وتعيين مجموعة أمان شبكة إلى واجهة جهاز ظاهري (VM) موجود مسبقًا.  بمجرد التكوين، ستراقب قواعد الوارد والصادر الافتراضية، وتنشئ قواعد جديدة وتختبرها.  في هذا النشاط المعملي، يتم إنشاء الجهاز الظاهري الذي ستستخدمه مع مجموعة أمان الشبكة من أجلك، لذلك ستقوم أولاً بعرض بعض المعلومات المرتبطة بهذا الجهاز الظاهري.
  
**الوقت** المقدر: 45 دقيقة

### المهمة 1

في هذه المهمة، ستتولى عرض بعض المعلمات المقترنة بالجهاز الظاهري التي تم إنشاؤها للاستخدام مع هذا النشاط المعملي.

1. افتح مستعرض Microsoft Edge.  في شريط العناوين، أدخِل **https://portal.azure.com**.

1. سجل الدخول باستخدام بيانات اعتماد المسؤول خاصتك.
    1. في نافذة تسجيل الدخول، أدخل اسم المستخدم الذي يوفره موفر استضافة النشاط المعملي ثم حدد **التالي**.
    1. أدخل كلمة مرور المسؤول التي يجب أن يوفرها موفر استضافة النشاط المعملي الخاص بك. حدد **تسجيل الدخول**.
    1. اعتمادا على مضيف المختبر الخاص بك وإذا كانت هذه هي المرة الأولى التي تقوم فيها بتسجيل الدخول إلى المستأجر، فقد تتم مطالبتك بإكمال عملية تسجيل المصادقة متعددة العوامل. إذا كان الأمر كذلك، فاتبع المطالبات على الشاشة لإعداد المصادقة متعددة العوامل.

1. في أعلى الصفحة، أسفل المكان المذكور فيه Azure Services، حدد **Virtual Machines**.  إذا كنت لا تراها مدرجة، ففي مربع البحث، في الشريط الأزرق أعلى الصفحة بجوار المكان المذكور فيه Microsoft Azure، أدخِل **Virtual Machines** ثم حدد **Virtual Machines** من نتائج البحث.

1. من صفحة Virtual machines، حدد الجهاز الظاهري المدرج **SC900-WinVM**.

1. أنت الآن في صفحة SC900-WinVM.  لاحظ بعض المعلومات الأساسية حول الجهاز الظاهري.

1. من لوحة التنقل اليسرى، قم بتوسيع **Networking** ثم حدد **Network Settings**.  تعرض أقسام الأساسيات في النافذة الرئيسية واجهة الشبكة للجهاز الظاهري.  لاحظ أنه لا يوجد أي شيء مدرج بجوار مجموعة أمان الشبكة، حيث لم تُعين NSG للواجهة.

1. أبقِ علامة التبويب هذه مفتوحة.

### المهمة 2

في هذه المهمة، ستنشئ مجموعة أمان شبكة، وتعين واجهة الشبكة للجهاز الظاهري إلى مجموعة أمان الشبكة تلك، وتنشئ قاعدة وارد جديدة لنقل بيانات RDP.

1. من علامة تبويب Azure المفتوحة، انقر بزر الماوس الأيمن على ارتباط *الصفحة الرئيسية* أعلى الصفحة وحدد **فتح الارتباط في علامة تبويب جديدة** لفتح صفحة أخرى لخدمات Azure.

1. في شريط البحث الأزرق أعلى الصفحة، أدخل **مجموعات أمان الشبكة**، ومن النتائج، حدد **مجموعات أمان الشبكة**. لا تحدد *مجموعات أمان الشبكة (الكلاسيكية)*.

1. من وسط الصفحة، حدد الزر الأزرق المسمى **إنشاء مجموعة أمان الشبكة**.  بدلاً من ذلك، يمكنك تحديد **+ إنشاء** من أعلى صفحة مجموعات أمان الشبكة.

1. في علامة تبويب الأساسيات في صفحة إنشاء مجموعة أمان الشبكة، حدد الإعدادات التالية:
    1. الاشتراك: اترك القيمة الافتراضية (هذا هو اشتراك Azure الذي يوفره مضيف النشاط المعملي المعتمد)
    1. مجموعة الموارد: **LabsSC900**
    1. الاسم:  **NSG-SC900**
    1. المنطقة: اترك الإعداد الافتراضي.
    1. حدد **مراجعة + إنشاء**، ثم حدد **إنشاء**.

1. بمجرد اكتمال النشر، حدد **انتقال إلى المورد**.

1. يجب أن تكون في صفحة النظرة العامة لمجموعة أمان شبكة NSG التي جرى إنشاؤها حديثاً.  إذا لم يكن الأمر كذلك، فمن لوحة التنقل اليمنى، حدد **نظرة عامة**. في أعلى الصفحة أسفل المكان المذكور فيه Essentials، سترى بعض المعلومات الأساسية حول مجموعة أمان الشبكة التي أنشأتها.  نقطتان يجب ملاحظتها هما أنه لا توجد قواعد أمان مخصصة ولا توجد شبكات فرعية ولا واجهات شبكة مرتبطة بمجموعة أمان الشبكة هذه.  على الرغم من عدم وجود قواعد أمان مخصصة، إلا أن هناك قواعد افتراضية للوارد والصادر مضمنة مع كل مجموعة أمان شبكة، كما هو موضح في الصفحة.  راجع قواعد الوارد والصادر. ترفض قواعد الوارد الافتراضية جميع عمليات نقل البيانات الواردة التي ليست من شبكة ظاهرية أو Azure load balancer.  ترفض قواعد الصادر جميع عمليات نقل البيانات الصادرة باستثناء عمليات نقل البيانات بين الشبكات الظاهرية وعمليات نقل البيانات الصادرة إلى الإنترنت.

1. من جزء التنقل الأيمن في صفحة NSG-SC900، قم بتوسيع **الإعدادات** ثم حدد **واجهات** الشبكة.
    1. حدد **+ Associate.**
    2. في حقل "اقترانات واجهة الشبكة"، حدد **السهم لأسفل**، وحدد **sc900-winvmXXX**، ثم حدد **موافق** في أسفل النافذة. بمجرد ربط الواجهة بمجموعة أمان الشبكة، ستظهر في القائمة.  NSG الآن معينة على واجهة شبكة الجهاز الظاهري الخاص بك.

1. قم بالتبديل مرة أخرى إلى **علامة التبويب SC900-WinVM - Microsoft Azure** على المستعرض.  قم بتحديث الصفحة. بجوار المكان الذي تظهر فيه مجموعة أمان الشبكة، يمكن أن ترى يويو الآن اسم NSG الذي أنشأته للتو.  إذا كنت لا تزال لا ترى ذلك، فانتظر دقيقة أخرى ثم عليك تحديث الصفحة مرة أخرى.

1. من جزء التنقّل الأيسر، حدد **اتصال**. من النافذة الرئيسية، بجوار المكان الذي يظهر فيه رقم المنفذ 3389، حدد **التحقق من الوصول**. ترسل وظيفة التحقق من الوصول إشارات (نسبة استخدام الشبكة) إلى منفذ RDP الافتراضي 3389 الخاص بالجهاز الظاهري للتحقق من إمكانية الوصول إليه. قد يستغرق الأمر دقيقة، ولكن سترى لا يمكن الوصول.  هذا متوقع، لأن قاعدة DenyAllInBound NSG ترفض كافة نسبة استخدام الشبكة الواردة إلى الجهاز الظاهري.

1. يمكن التبديل مرة أخرى إلى علامة التبويب **NSG-SC900 - Microsoft Azure** في المستعرض.

1. من جزء التنقل الأيسر، حدد **Inbound security rules**. ترفض قواعد الوارد الافتراضية جميع عمليات نقل البيانات الواردة التي ليست من شبكة ظاهرية أو Azure load balancer، لذلك تحتاج إلى إعداد قاعدة للسماح بنقل بيانات RDP الواردة (نقل البيانات على المنفذ 3389). تذكر أنه لا يمكنك إزالة القواعد الافتراضية، ولكن يمكنك تجاوزها بإنشاء قواعد ذات أولويات أعلى.

1. من أعلى الصفحة، حدد **إضافة**. في نافذة «Add inbound security rule»، حدد الإعدادات التالية:
    1. المصدر: **أي**
    1. نطاقات منفذ المصدر: **\***
    1. الوجهة: **أي**
    1. الخدمة: **RDP**
    1. الإجراء: **سماح**
    1. Priority: **1000**. القواعد ذات الأرقام الأقل لها أولوية أعلى وتتم معالجتها أولاً.
    1. Name: اترك الاسم الافتراضي أو أنشئ الاسم الوصفي الخاص بك.
    1. لاحظ علامة التحذير في أسفل الصفحة.  نحن نستخدم RDP فقط لأغراض الاختبار ولتوضيح وظائف مجموعة أمان الشبكة.
    1. حدد **إضافة**

1. بمجرد توفير القاعدة، ستظهر في قائمة القواعد الواردة (قد تحتاج إلى تحديث الشاشة).

1. اترك علامة تبويب المستعرض هذه مفتوحة.  

### المهمة 3

في هذه المهمة، ستختبر قاعدة مجموعة أمان الشبكة للوارد التي تم إنشاؤها حديثًا للتأكد من أنه يمكنك إنشاء اتصال سطح مكتب بعيد (RDP) بالجهاز الظاهري.  بمجرد دخولك إلى الجهاز الظاهري، ستعمل على التحقق من الاتصال الصادر بالإنترنت من الجهاز الظاهري.

1. افتح علامة تبويب SC900-WinVM – Microsoft Azure في المستعرض.

1. حدد **اتصال** من لوحة التنقل اليسرى.

1. حدد **التحقق من الوصول** (تحقق من تعيين المنفذ إلى 3389).  يجب أن تظهر الحالة على أنها "يمكن الوصول إليها".  إذا كنت لا تزال ترى "لا يمكن الوصول إليها"، فقم بتحديث الصفحة وحاول مرة أخرى، فقد يستغرق الأمر بضع دقائق حتى يتم رؤية القاعدة الواردة الجديدة بواسطة خيار الوصول إلى التحقق.

1. اتصل الآن مباشرةً بالجهاز الظاهري بالنقر فوق **تحديد** في المربع الذي يشير إلى Native RDP.
   
    1. من نافذة RDP الأصلية التي تفتح، حدد **تنزيل ملف RDP**.
    1. في حالة ظهور تحذير التنزيل، حدد **احتفاظ**، ثم في النافذة المنبثقة التي تظهر، حدد **فتح ملف**.
    1. تفتح نافذة "اتصال سطح المكتب البعيد"، حدد **اتصال**.
    1. سيُطلب منك بيانات الاعتماد.  أدخل اسم المستخدم وكلمة المرور للجهاز الظاهري (راجع علامة تبويب الموارد في لوحة تعليمات المعمل).
    1. يتم فتح نافذة "اتصال سطح المكتب البعيد" للإشارة إلى أنه *: لا يمكن التحقق من هوية الكمبيوتر البعيد. هل تريد الاتصال على أي حال؟*  حدد **نعم**.

1. أنت الآن متصل بالجهاز الظاهري. في هذه الحالة كان بإمكانك الاتصال بالجهاز الافتراضي لأن قاعدة نسبة استخدام الشبكة الواردة التي أنشأتها تسمح بنسبة استخدام الشبكة الواردة إلى الجهاز الظاهري عبر بروتوكول سطح المكتب البعيد.  بعد بضع ثوانٍ على شاشة الترحيب، قد ترى نافذة لاختيار إعدادات الخصوصية لجهازك، عندئذٍ حدد **قبول**.  وإذا ظهرت نافذة الشبكات، فحدد **لا**.

1. وعند تشغيل الجهاز الظاهري في جلسة RDP، اختبر الاتصال الخارجي بالإنترنت من الجهاز الظاهري.
    1. من الجهاز الظاهري المفتوح، حدد **Microsoft Edge** لفتح المستعرض. نظرا لأن هذه هي المرة الأولى التي تفتح فيها الجهاز الظاهري والأخوة، فقد تتم مطالبتك ببعض الإعدادات الأساسية.  
    1. قد تتم مطالبتك باختيار إعدادات الخصوصية لجهازك. اترك الإعداد الافتراضي وحدد **قبول**.  
    1. قد يتم عرض لوحة جانبية للشبكات.  حدد **لا**.
    1. قد تظهر نافذة تقول "استعراض الويب باستخدام المستعرض الأفضل أداء على Windows"، حدد متابعة، وحدد **البدء بدون بياناتك**، وحدد **تأكيد ومتابعة**، وحدد **متابعة بدون هذه البيانات**، ثم أخيرا حدد **تأكيد وبدء الاستعراض**.****
    1. أدخِل **www.bing.com** في شريط عنوان المستعرض وتأكد من قدرتك على الاتصال بمحرك البحث.
    1. بمجرد التأكد من أنه يمكنك الوصول إلى www.bing.com، أغلق نافذة المستعرض في الجهاز الظاهري، ولكن اترك الجهاز الظاهري مفتوحًا.

1. صغّر الجهاز الظاهري، عن طريق تحديد التسطير السفلي **_** في علامة التبويب الزرقاء التي تعرض عنوان IP الخاص بالجهاز الظاهري. وهذا يعيدك إلى صفحة SC900-WinVM \| الاتصال.

1. اترك علامة تبويب المستعرض هذه مفتوحة، حيث ستستخدمها في المهمة التالية.

### المهمة 4

في المهمة السابقة، تأكدت من أنه يمكنك إنشاء اتصال RDP بالجهاز الظاهري. بمجرد دخولك إلى الجهاز الظاهري، تأكدت أيضًا من أنه يمكنك إنشاء اتصال صادر بالإنترنت.  تم السماح بنقل بيانات الإنترنت الصادرة لأن قواعد الصادر الافتراضية لمجموعة أمان الشبكة تسمح بنقل بيانات الإنترنت الصادرة.  في هذه المهمة، ستنتقل إلى عملية إنشاء قاعدة مخصصة للصادر لحظر نقل بيانات الإنترنت الصادرة واختبار هذه القاعدة.

1. ينبغي أن تكون على صفحة SC900-WinVM \| الاتصال. من لوحة التنقل اليسرى، حدد **Networking**. إذا قمت مسبقًا بإغلاق علامة تبويب المستعرض، فحدد شريط البحث الأزرق أعلى الصفحة وحدد Virtual machines، ثم حدد الجهاز الظاهري، **SC900-WinVM**، ثم حدد **Networking**.

1. حدد علامة التبويب **Outbound port rules**. سترى قواعد الصادر الافتراضية.  لاحظ القاعدة الافتراضية "AllowInternetOutBound". تسمح هذه القاعدة بكل حركة الإنترنت الصادرة. لا يمكنك إزالة القاعدة الافتراضية، ولكن يمكنك تجاوزها بإنشاء قواعد ذات أولويات أعلى. من الجانب الأيسر من الصفحة، حدد **+Crate port rule** ثم من القائمة المنسدلة، حدد **Outbound port rule**.

1. في صفحة إضافة قاعدة أمان الصادر، حدد الإعدادات التالية:
    1. المصدر: **أي**
    1. نطاقات منفذ المصدر: **\***
    1. الوجهة: **علامة خدمة**
    1. علامة خدمة الوجهة: **الإنترنت**
    1. الخدمة: **مخصص** (اترك الإعداد الافتراضي)
    1. نطاقات منفذ الوجهة: **\*** (تأكد من وضع علامة النجمة في حقل نطاقات منفذ الوجهة).
    1. البروتوكول **أي**.
    1. الإجراء: **الرفض**
    1. Priority:  **1000**
    1. Name: اترك الاسم الافتراضي أو أنشئ الاسم الوصفي الخاص بك.
    1. حدد **إضافة**

1. بمجرد توفير القاعدة، ستظهر في قائمة قواعد الصادر.  رغم ظهوره في القائمة، إلا أنه سيستغرق بضع دقائق حتى يصبح ساريًا (انتظر بضع دقائق قبل متابعة الخطوات التالية).  


1. ارجع إلى الجهاز الظاهري (ينبغي عرض أيقونة RDP للجهاز الظاهري على شريط المهام أسفل الصفحة).

1. افتح مستعرض Microsoft Edge على جهازك الظاهري وأدخِل **www.bing.com**. لا ينبغي عرض الصفحة. إذا كنتَ قادرًا على الاتصال بالإنترنت وتحققتَ من تعيين جميع معلمات قاعدة الصادر بشكلٍ صحيح، فمن المحتمل أن يستغرق الأمر بضع دقائق حتى تصبح القاعدة سارية المفعول.  أغلق المستعرض، انتظر بضع دقائق وحاول مرة أخرى. قد تواجه اشتراكات Azure في بيئة النشاط المعملي تأخيرات أطول من المعتاد.

1. أغلق اتصال سطح المكتب البعيد، عن طريق تحديد **X** في أعلى منتصف الصفحة حيث يظهر عنوان IP.  تظهر نافذة منبثقة تظهر Your remote session will be disconnected. حدد **موافق**.

1. من الزاوية العلوية اليسرى من النافذة، أسفل الشريط الأزرق مباشرةً حيث تظهر عبارة Microsoft Azure، حدد **الصفحة الرئيسية** للعودة إلى الصفحة الرئيسية لخدمات Azure.

1. احتفظ بعلامة تبويب Azure مفتوحة على المستعرض.

### المراجعة

في هذا النشاط المعملي، مررت بعملية إعداد مجموعة أمان شبكة (NSG)، وإقران مجموعة أمان الشبكة هذه بواجهة شبكة الجهاز الظاهري، وإضافة قواعد جديدة إلى مجموعة أمان الشبكة للسماح بنقل بيانات RDP الواردة ولحظر نقل بيانات الإنترنت الصادرة.
